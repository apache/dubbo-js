## dubbo2.js

![love dubbo](https://raw.githubusercontent.com/dubbo/dubbo2.js/master/resources/dubbo-love.png)

[![NPM](https://nodei.co/npm/dubbo2.js.png?downloads=true&downloadRank=true&stars=true)](https://nodei.co/npm/dubbo2.js)

> dubbo2.js = Nodejs connected Java Dubbo service by dubbo protocol (dubbo head + hessian body)

å¤šå¹´æœŸç›¼ï¼Œä¸€æœæ¢¦åœ†ï¼ We love dubbo ğŸ‘

æ„Ÿè°¢ [js-to-java](https://github.com/node-modules/js-to-java),[hessian.js](https://github.com/node-modules/hessian.js) ä¸¤å¤§æ ¸å¿ƒæ¨¡å—, æ„Ÿè°¢[fengmk2](https://github.com/fengmk2)å’Œ[dead-horse](https://github.com/dead-horse)è€å¸ˆã€‚

## Features

1.  Keep it Simple (build tools for humans).

2.  Support zookeeper as register center

3.  TCP Dubbo Native protocol ï¼ˆDubbo Header + Hessian Bodyï¼‰

4.  Socket Container (ServerAgent -> SocketWorker)

5.  Support Directly Dubbo (const Dubbo = DirectlyDubbo({..}))

6.  Middleware the same as Koa middleware, Easy to extend.

7.  Tracing (runtime info, call stack)

8.  Supported Dubbox

9.  Typescript type definition

10. Convert java dubbo interface to typescript module by interpret tools

11. SocketWorker was disconnected auto retry

## Getting Started

```shell
yarn add dubbo2.js
```

## How to Usage?

### dubbo2.js@2.0.4+

```typescript
//=====================service.ts==================
//generated by interpret tools
import {BasicTypeProvider} from './providers/com/alibaba/dubbo/demo/BasicTypeProvider';
import {DemoProvider} from './providers/com/alibaba/dubbo/demo/DemoProvider';
import {ErrorProvider} from './providers/com/alibaba/dubbo/demo/ErrorProvider';

export default {
  BasicTypeProvider,
  DemoProvider,
  ErrorProvider,
};

//===============dubbo.ts========================
import {Dubbo} from 'dubbo2.js';
import service from './service';

//åˆ›å»ºdubboå¯¹è±¡
const dubbo = new Dubbo<typeof service>({
  application: {name: 'node-dubbo'},
  //zookeeper address
  register: 'localhost:2181',
  service,
});

//main method
(async () => {
  let {res, err} = await dubbo.service.DemoProvider.sayHello('node');
  //print {err: null, res:'hello node from dubbo service'}
  ({res, err} = await dubbo.service.DemoProvider.echo());
  //print {err: null, res: 'pang'}
  ({res, err} = await dubbo.service.DemoProvider.getUserInfo());
  //status: 'ok', info: { id: '1', name: 'test' }
})();
```

## ä¸æ˜¯ä» java è‡ªåŠ¨ç”Ÿæˆçš„ typescript ä»£ç ï¼Œå¦‚ä½•æ³¨å…¥åˆ° dubbo å¯¹è±¡ä¸­ï¼Ÿ

```typescript
//åˆ›å»ºè¦æ³¨å…¥çš„service
import {Dubbo} from 'dubbo2.js';
const demoProvider = dubbo =>
  dubbo.proxyService({
    dubboInterface: 'com.alibaba.dubbo.demo.DemoProvider',
    version: '1.0.0',
    methods: {
      sayHello(name) {
        return [java.String(name)];
      },

      echo() {},

      test() {},

      getUserInfo() {
        return [
          java.combine('com.alibaba.dubbo.demo.UserRequest', {
            id: 1,
            name: 'nodejs',
            email: 'node@qianmi.com',
          }),
        ];
      },
    },
  });

//å°†è¯¥serviceåˆå…¥dubboå¯¹è±¡æ„é€ å‡½æ•°çš„serviceå¯¹è±¡ä¸­
const service = {
  demoProvider,
};

const dubbo = new Dubbo<typeof service>({
  //  ....other parameters
  service,
});
```

### dubbo2.js@1.xxx

```typescript
import {Dubbo, java, TDubboCallResult} from 'dubbo2.js';
//generated by interpret tools
import {BasicTypeProvider} from './providers/com/alibaba/dubbo/demo/BasicTypeProvider';
import {DemoProvider} from './providers/com/alibaba/dubbo/demo/DemoProvider';
import {ErrorProvider} from './providers/com/alibaba/dubbo/demo/ErrorProvider';

//åˆ›å»ºdubboå¯¹è±¡
const dubbo = new Dubbo({
  application: {name: 'node-dubbo'},
  //zookeeper address
  register: 'localhost:2181',
  interfaces: [
    'com.alibaba.dubbo.demo.DemoProvider',
    'com.alibaba.dubbo.demo.BasicTypeProvider',
    'com.alibaba.dubbo.demo.ErrorProvider',
  ],
});

const basicTypeProvider = BasicTypeProvider(dubbo);
const demoProvider = DemoProvider(dubbo);
const errorProvider = ErrorProvider(dubbo);

//main method
(async () => {
  let {res, err} = await demoProvider.sayHello('node');
  //print {err: null, res:'hello node from dubbo service'}
  ({res, err} = await demoProvider.echo());
  //print {err: null, res: 'pang'}
  ({res, err} = await demoProvider.getUserInfo());
  //status: 'ok', info: { id: '1', name: 'test' }
})();
```


## as developer

```sh
brew install zookeeper
brew services start zookeeper

#è¿è¡Œjava/dubbo-demo-providerä¸‹é¢çš„ä¾‹å­

yarn run test

# å…¨é“¾è·¯æ—¥å¿—è·Ÿè¸ª
DEBUG=dubbo* yarn run test
```

## dubbo flow graph

![dubbo-flow](https://raw.githubusercontent.com/dubbo/dubbo2.js/master/resources/dubbo2-flow.png)

## API

### create dubbo object

```javascript
const dubbo = new Dubbo({
  isSupportedDubbox     //æ˜¯å¦æ”¯æŒdubbox - boolean, é»˜è®¤false, å¯é€‰
  application           //è®°å½•åº”ç”¨çš„åç§° - zookeeperçš„è°ƒç”¨æ—¶å€™å†™å…¥consumer, ç±»å‹({name: string};) å¯é€‰
  dubboInvokeTimeout    //è®¾ç½®dubboè°ƒç”¨è¶…æ—¶æ—¶é—´ - numberç±»å‹, é»˜è®¤10s, å¯é€‰
  dubboSocketPool       //è®¾ç½®dubboåˆ›å»ºsocketçš„poolå¤§å° - ç±»å‹number, é»˜è®¤4, å¯é€‰
  register              //è®¾ç½®zookeeperæ³¨å†Œä¸­å¿ƒåœ°å€ - ç±»å‹string, å¿…å¡«
  zkRoot                //zkçš„é»˜è®¤æ ¹è·¯å¾„ - ç±»å‹string, é»˜è®¤/dubbo
  interfaces            //è®¾ç½®zkç›‘å¬çš„æ¥å£åç§° - ç±»å‹ Array<string>, å¿…å¡«, åœ¨dubbo2.js@2.0.4+ç‰ˆæœ¬ä¸­ä¸åœ¨ä½¿ç”¨è¿™ä¸ªå‚æ•°
  service               //æ³¨å…¥åˆ°dubboå®¹å™¨çš„dubboæœåŠ¡ - ç±»å‹Object, åœ¨dubbo2.js@2.0.4+ä½¿ç”¨
});

// Or
const dubbo = Dubbo.from({
  isSupportedDubbox     //æ˜¯å¦æ”¯æŒdubbox - ç±»å‹boolean, é»˜è®¤false, å¯é€‰
  application           //è®°å½•åº”ç”¨çš„åç§° - zookeeperçš„è°ƒç”¨æ—¶å€™å†™å…¥consumer, ç±»å‹({name: string};) å¯é€‰
  dubboInvokeTimeout    //è®¾ç½®dubboè°ƒç”¨è¶…æ—¶æ—¶é—´ - numberç±»å‹, é»˜è®¤10s, å¯é€‰
  dubboSocketPool       //è®¾ç½®dubboåˆ›å»ºsocketçš„poolå¤§å° - ç±»å‹number, é»˜è®¤4, å¯é€‰
  register              //è®¾ç½®zookeeperæ³¨å†Œä¸­å¿ƒåœ°å€ - ç±»å‹string, å¿…å¡«
  zkRoot                //zkçš„é»˜è®¤æ ¹è·¯å¾„ - ç±»å‹string, é»˜è®¤/dubbo
  interfaces            //è®¾ç½®zkç›‘å¬çš„æ¥å£åç§° - ç±»å‹ Array<string>, å¿…å¡«, åœ¨dubbo2.js@2.0.4+ç‰ˆæœ¬ä¸­ä¸åœ¨ä½¿ç”¨è¿™ä¸ªå‚æ•°
  service               //æ³¨å…¥åˆ°dubboå®¹å™¨çš„dubboæœåŠ¡ - ç±»å‹Object, åœ¨dubbo2.js@2.0.4+ä½¿ç”¨
})


//dubboçš„ä»£ç†æœåŠ¡
const demoSerivce = dubbo.proxService({
  //ä»£ç†çš„æœåŠ¡æ¥å£ - string å¿…ä¼ 
  dubboInterface: 'com.alibaba.dubbo.demo.DemoService',
  //æœåŠ¡æ¥å£çš„ç‰ˆæœ¬ - string å¯é€‰
  version: '1.0.0',
  //è¶…æ—¶æ—¶é—´ number å¯é€‰
  timeout: 10
  //æ‰€å±ç»„ string å¯é€‰
  group: 'qianmi',
  //æ¥å£å†…çš„æ–¹æ³• - Array<Function> å¿…ä¼ 
  methods: {
    //method name
    sayHello(name) {
      //ä»…åšå‚æ•°hessianåŒ–è½¬æ¢
      return [java.String(name)];
    },
    //method name
    getUserInfo() {
      //ä»…åšå‚æ•°hessianåŒ–è½¬æ¢
      return [
        java.combine('com.alibaba.dubbo.demo.UserRequest', {
          id: 1,
          name: 'nodejs',
          email: 'node@qianmi.com',
        }),
      ];
    },
  },
})
```

### connect dubbo directly

```typescript
import {DirectlyDubbo, java} from 'dubbo2.js';
import {
  DemoProvider,
  DemoProviderWrapper,
  IDemoProvider,
} from './providers/com/alibaba/dubbo/demo/DemoProvider';
import {UserRequest} from './providers/com/alibaba/dubbo/demo/UserRequest';

const dubbo = DirectlyDubbo.from({
  dubboAddress: 'localhost:20880',
  dubboVersion: '2.0.0',
  dubboInvokeTimeout: 10,
});

const demoService = dubbo.proxyService<IDemoProvider>({
  dubboInterface: 'com.alibaba.dubbo.demo.DemoProvider',
  methods: DemoProviderWrapper,
  version: '1.0.0',
});
```

## When dubbo was ready?

```javascript
const dubbo = Dubbo.from(/*...*/);

(async () => {
  await dubbo.ready();
  //TODO dubbo was ready
})();

//for example, in egg.js
app.beforeStart(async () => {
  await dubbo.ready();
  app.logger.info('dubbo was ready...');
});
```

## How to trace dubbo2.js runtime system info?

```javascript
const dubbo = Dubbo.from(/*...*/);

//é€šè¿‡subscribe
dubbo.subcribe({
  onTrace(msg: ITrace) {
    //logger msg
  },
});
```

You will get all runtim system info just like this.

```text
{ type: 'INFO', msg: 'dubbo:bootstrap version => 2.1.5' }
{ type: 'INFO', msg: 'connected to zkserver localhost:2181' }
{ type: 'INFO',
  msg: 'ServerAgent create socket-pool: 172.19.6.203:20880' }
{ type: 'INFO',
  msg: 'socket-pool: 172.19.6.203:20880 poolSize: 1' }
{ type: 'INFO',
  msg: 'new SocketWorker#1 |> 172.19.6.203:20880' }
{ type: 'INFO',
  msg: 'SocketWorker#1 =connecting=> 172.19.6.203:20880' }
{ type: 'INFO',
  msg: 'SocketWorker#1 <=connected=> 172.19.6.203:20880' }
{ type: 'INFO', msg: 'scheduler is ready' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.DemoProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.ErrorProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.BasicTypeProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'ERR',
  msg: Error: Can not be found any agents
    at Object.Scheduler._handleZkClientOnData [as onData] (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/scheduler.js:68:29)
    at EventEmitter.<anonymous> (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/zookeeper.js:275:30)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:118:7) }
{ type: 'ERR',
  msg: Error: SocketWorker#1 <=closed=> 172.19.6.203:20880 retry: 6
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:78:29)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'INFO',
  msg: 'SocketWorker#1 =connecting=> 172.19.6.203:20880' }
{ type: 'ERR',
  msg:
   { Error: connect ECONNREFUSED 172.19.6.203:20880
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1173:14)
     errno: 'ECONNREFUSED',
     code: 'ECONNREFUSED',
     syscall: 'connect',
     address: '172.19.6.203',
     port: 20880 } }
{ type: 'ERR',
  msg: Error: SocketWorker#1 <=closed=> 172.19.6.203:20880 retry: 5
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:78:29)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.DemoProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.BasicTypeProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.ErrorProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.ErrorProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.DemoProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.BasicTypeProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'ERR',
  msg: Error: Can not be found any agents
    at Object.Scheduler._handleZkClientOnData [as onData] (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/scheduler.js:68:29)
    at EventEmitter.<anonymous> (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/zookeeper.js:275:30)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:118:7) }
{ type: 'INFO',
  msg: 'SocketWorker#1 =connecting=> 172.19.6.203:20880' }
{ type: 'ERR',
  msg:
   { Error: connect ECONNREFUSED 172.19.6.203:20880
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1173:14)
     errno: 'ECONNREFUSED',
     code: 'ECONNREFUSED',
     syscall: 'connect',
     address: '172.19.6.203',
     port: 20880 } }
{ type: 'ERR',
  msg: Error: SocketWorker#1 <=closed=> 172.19.6.203:20880 retry: 4
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:78:29)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'INFO',
  msg: 'SocketWorker#1 =connecting=> 172.19.6.203:20880' }
{ type: 'ERR',
  msg:
   { Error: connect ECONNREFUSED 172.19.6.203:20880
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1173:14)
     errno: 'ECONNREFUSED',
     code: 'ECONNREFUSED',
     syscall: 'connect',
     address: '172.19.6.203',
     port: 20880 } }
{ type: 'ERR',
  msg: Error: SocketWorker#1 <=closed=> 172.19.6.203:20880 retry: 3
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:78:29)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'INFO',
  msg: 'SocketWorker#1 =connecting=> 172.19.6.203:20880' }
{ type: 'ERR',
  msg:
   { Error: connect ECONNREFUSED 172.19.6.203:20880
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1173:14)
     errno: 'ECONNREFUSED',
     code: 'ECONNREFUSED',
     syscall: 'connect',
     address: '172.19.6.203',
     port: 20880 } }
{ type: 'ERR',
  msg: Error: SocketWorker#1 <=closed=> 172.19.6.203:20880 retry: 2
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:78:29)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'INFO',
  msg: 'SocketWorker#1 =connecting=> 172.19.6.203:20880' }
{ type: 'ERR',
  msg:
   { Error: connect ECONNREFUSED 172.19.6.203:20880
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1173:14)
     errno: 'ECONNREFUSED',
     code: 'ECONNREFUSED',
     syscall: 'connect',
     address: '172.19.6.203',
     port: 20880 } }
{ type: 'ERR',
  msg: Error: SocketWorker#1 <=closed=> 172.19.6.203:20880 retry: 1
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:78:29)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'INFO',
  msg: 'SocketWorker#1 =connecting=> 172.19.6.203:20880' }
{ type: 'ERR',
  msg:
   { Error: connect ECONNREFUSED 172.19.6.203:20880
    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1173:14)
     errno: 'ECONNREFUSED',
     code: 'ECONNREFUSED',
     syscall: 'connect',
     address: '172.19.6.203',
     port: 20880 } }
{ type: 'ERR',
  msg: Error: SocketWorker#1 <=closed=> 172.19.6.203:20880 retry: 0
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:78:29)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'ERR',
  msg: Error: 172.19.6.203:20880's pool socket-worker had all closed. delete 172.19.6.203:20880
    at ServerAgent._clearClosedPool (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/server-agent.js:66:33)
    at Object.onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/server-agent.js:51:34)
    at SocketWorker._onClose (/Users/hufeng/Github/dubbo2.js/packages/dubbo/es7/socket-worker.js:97:34)
    at Socket.emit (events.js:180:13)
    at TCP._handle.close [as _onclose] (net.js:541:12) }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.DemoProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'ServerAgent create socket-pool: 172.19.6.203:20880' }
{ type: 'INFO',
  msg: 'socket-pool: 172.19.6.203:20880 poolSize: 1' }
{ type: 'INFO',
  msg: 'new SocketWorker#2 |> 172.19.6.203:20880' }
{ type: 'INFO',
  msg: 'SocketWorker#2 =connecting=> 172.19.6.203:20880' }
{ type: 'INFO',
  msg: 'SocketWorker#2 <=connected=> 172.19.6.203:20880' }
{ type: 'INFO', msg: 'scheduler is ready' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.BasicTypeProvider/providers, type: NODE_CHILDREN_CHANGED' }
{ type: 'INFO',
  msg: 'trigger watch /dubbo/com.alibaba.dubbo.demo.ErrorProvider/providers, type: NODE_CHILDREN_CHANGED' }
```

## middleware

æŠ½è±¡ä½¿ç”¨è°ƒç”¨é“¾è·¯ï¼Œå¹¶ä½¿ç”¨ä¸ koaç›¸åŒçš„ middlewareæœºåˆ¶ã€‚æ˜“äºè‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œå¦‚ï¼šloggerã€‚

```js
//cost-time middleware
dubbo.use(async (ctx, next) => {
  const startTime = Date.now();
  await next();
  const endTime = Date.now();
  console.log('invoke cost time->', endTime - startTime);
});
```

## dubbo-invoker

dubbo æ¥å£è°ƒç”¨ä¸­ï¼Œéœ€è®¾ç½®æŸäº›åŠ¨æ€å‚æ•°ï¼Œå¦‚ï¼šversion, group, timeout, retry, ç­‰ã€‚

å‚æ•°åœ¨ consumer è°ƒç”¨æ—¶èµ‹å€¼ã€‚åœ¨æ­¤ï¼ŒæŠ½è±¡ä¸€ä¸ª dubbo-invoker ä½œä¸ºè®¾ç½®å‚æ•°çš„ middlewareï¼Œä¾¿äºåŠ¨æ€è®¾ç½® runtime å‚æ•°ã€‚

```javascript
import {dubboInvoker, matcher} from 'dubbo-invoker';

//init
const dubbo = Dubbo.from(/*....*/);

const matchRuler = matcher
  //ç²¾ç¡®åŒ¹é…æ¥å£
  .match('com.alibaba.demo.UserProvider', {
    version: '1.0.0',
    group: 'user',
  })
  //match thunk
  .match(ctx => {
    if (ctx.dubboInterface === 'com.alibaba.demo.ProductProvider') {
      ctx.version = '2.0.0';
      ctx.group = 'product-center';
      //é€šçŸ¥dubboInvokeråŒ¹é…æˆåŠŸ
      return true;
    }
  })
  //æ­£åˆ™åŒ¹é…
  .match(/^com.alibaba.dubbo/, {
    version: '2.0.0',
    group: '',
  });

dubbo.use(dubboInvoke(matchRuler));
```

## Translator => Cool.

å¼€å‘ä½“éªŒä¸ç”¨æˆ·ä½“éªŒåŒæ ·é‡è¦ã€‚ä¸ºæ­¤ï¼Œdubbo2.jsåšäº†ä¸€äº›åˆ›æ–°ä¸å®è·µã€‚

ä¸ºä½¿ node å’Œ dubbo ä¹‹é—´çš„è°ƒç”¨åƒ java è°ƒç”¨ dubbo ä¸€æ ·ç®€å•é€æ˜ï¼Œå…¶ä¸­è®¾è®¡å¹¶å®ç°äº† [translator](./packages/interpret-cli).

é€šè¿‡åˆ†æ java çš„ jar åŒ…ä¸­çš„ bytecode æå– dubbo è°ƒç”¨çš„æ¥å£ä¿¡æ¯ï¼Œè‡ªåŠ¨ç”Ÿæˆ typescript ç±»å‹å®šä¹‰æ–‡ä»¶ä»¥åŠè°ƒç”¨çš„ä»£ç ã€‚


**_èŒè´£_**

1.  ç¿»è¯‘ Interface ä»£ç ,ç”Ÿæˆ node ç«¯å¯è°ƒç”¨ä»£ç ;
2.  è‡ªåŠ¨å°†å‚æ•°è½¬æ¢ä¸º hessian.js èƒ½è¯†åˆ«çš„å¯¹è±¡;
3.  æ¥å£æ–¹æ³•åŠå‚æ•°ç±»å‹æç¤º;

[translator è¯¦ç»†ä»‹ç»](./packages/interpret-cli)

## Performance

```text
â¯ loadtest -t 20 -c 200 http://localhost:3000/dubbo -k
[Wed Jun 20 2018 15:10:16 GMT+0800 (CST)] INFO Requests: 0, requests per second: 0, mean latency: 0 ms
[Wed Jun 20 2018 15:10:21 GMT+0800 (CST)] INFO Requests: 37305, requests per second: 7484, mean latency: 26.9 ms
[Wed Jun 20 2018 15:10:26 GMT+0800 (CST)] INFO Requests: 79187, requests per second: 8371, mean latency: 23.9 ms
[Wed Jun 20 2018 15:10:31 GMT+0800 (CST)] INFO Requests: 120374, requests per second: 8247, mean latency: 24.2 ms
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Target URL:          http://localhost:3000/dubbo
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Max time (s):        20
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Concurrency level:   200
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Agent:               keepalive
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Completed requests:  161828
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Total errors:        0
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Total time:          20.000902374000002 s
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Requests per second: 8091
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Mean latency:        24.7 ms
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO Percentage of the requests served within a certain time
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO   50%      22 ms
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO   90%      30 ms
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO   95%      34 ms
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO   99%      49 ms
[Wed Jun 20 2018 15:10:36 GMT+0800 (CST)] INFO  100%      134 ms (longest request)
```

## FAQ

```javascript
import {Dubbo} from 'dubbo2.js';
```

é»˜è®¤å¯¼å…¥çš„ dubbo2.js ç¼–è¯‘è¯­è¨€ï¼šes2017 ï¼ˆæ”¯æŒ node7.10+ ï¼‰ã€‚

ä½äºnode7.10çš„ç‰ˆæœ¬å¯ä½¿ç”¨ï¼š

```javascript
import {Dubbo} from 'dubbo2.js/es6';
```

## æ€ä¹ˆå‚ä¸å¼€å‘ï¼Ÿ

1.æ¬¢è¿ pr

2.æ¬¢è¿ issue

## åˆ†äº«ç›´æˆ³

[talk](https://github.com/hufeng/iThink/tree/master/talk)
